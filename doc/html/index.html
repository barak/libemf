<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>EMF: libEMF: Enhanced Metafile Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EMF
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">libEMF: Enhanced Metafile Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Table of Contents</p><ul>
<li><a class="el" href="index.html#intro">Introduction</a></li>
<li><a class="el" href="index.html#compilation">Compilation</a></li>
<li><a class="el" href="index.html#documentation">Documentation</a></li>
<li><a class="el" href="index.html#example">Example</a></li>
<li><a class="el" href="index.html#acknowledgements">Acknowledgements</a></li>
</ul>
<h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>libEMF is a C/C++ library which provides a drawing toolkit based on <a href="http://www.ecma.ch/ecma1/STAND/ECMA-234.HTM">ECMA-234</a>. The general purpose of this library is to create vector graphics files on POSIX systems which can be imported into <a href="http://www.openoffice.org">OpenOffice.org</a> or <a href="http://www.libreoffice.org">LibreOffice</a>. Times have changed, though. These days, you can import SVGs, or even PDFs, into OpenOffice or LibreOffice. Those are much better choices than EMF files.</p>
<p>My general interest in this library is for making scientific plots with <a href="http://www.gnuplot.info/">gnuplot</a> and <a href="http://plasma-gate.weizmann.ac.il/Grace/">Grace</a>(forthcoming). Therefore, this software includes patches to those programs to add the EMF as an output option. This library is mostly limited to the graphics commands required for gnuplot and Grace output drivers, though it's trivial to add new ones.</p>
<p>It is also possible now to generate EMF files from <a href="http://www.pstoedit.net/pstoedit/">PSTOEDIT</a> on POSIX systems. Therefore, if your graphics code only outputs PostScript, you can now easily convert it to EMF.</p>
<p><a href="http://sourceforge.net/projects/libemf">libEMF is hosted on SourceForge.</a></p>
<h1><a class="anchor" id="compilation"></a>
Compilation</h1>
<p>libEMF uses a standard autoconf-generated configure script to prepare it for compilation. If you want to activate printing of EMF records, run the configure script with: </p><div class="fragment"><div class="line">./configure --enable-editing</div></div><!-- fragment --><p>A single program is provided which can print the complete contents of a metafie (as far as the library understands them, anyway),</p>
<div class="fragment"><div class="line">printemf metafile.emf</div></div><!-- fragment --><h1><a class="anchor" id="documentation"></a>
Documentation</h1>
<p>The documentation of this project is generated with Doxygen and is largely for the internals of the library. However, the graphics commands which are available from C are <a href="libemf_8cpp.html">given here</a>.</p>
<h1><a class="anchor" id="example"></a>
Example</h1>
<p>You will probably only use libEMF in the context of an output driver for another graphics program, but should you want to do some custom graphics generation, here is an annotated example.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;emf.h&gt;</span> <span class="comment">// Will depend on your installation of libEMF</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main ( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[] )</div><div class="line">{</div></div><!-- fragment --><p>The first step is to create a device context for the metafile. The usual way this is accomplished is by acquiring a copy of the "desktop" device context and using it as a starting point for the metafile device context. libEMF supports the commands GetDesktopWindow() and GetDC(), but they are just dummy functions. The metafile device context has its own internal definitions.</p>
<p>The metafile creation subroutine takes four arguments (the first of which, the reference device context as obtained above, is ignored). The second argument is the path name of the metafile; you can use whatever name is valid on the system, but SO/OO.org prefers the file to end with the .emf extension. The third argument gives the size and position of the metafile; since SO/OO.org ignores the position, the first two values should be zero; the second pair of values should give the desired physical width and height of the drawing in units of 1/1000-th centimeters. The last argument to the creation routine is the description of the metafile; by convention, this consists of two null-terminated strings with an extra '\0' at the end.</p>
<div class="fragment"><div class="line">HWND desktop = GetDesktopWindow();</div><div class="line">HDC dc = GetDC( desktop );</div><div class="line"></div><div class="line">RECT size = { 0, 0, 10000, 10000 }; <span class="comment">// 10cm x 10cm</span></div><div class="line">PCSTR filename = <span class="stringliteral">&quot;example.emf&quot;</span>;</div><div class="line">PCSTR description = <span class="stringliteral">&quot;Example metafile created\0with libEMF\0&quot;</span>;</div><div class="line"></div><div class="line">HDC metaDC = CreateEnhMetaFile( 0, filename, &amp;size, description );</div></div><!-- fragment --><p>Next, we want to set the drawing properties of the pen, brush and font to something other than the default, say a wide, cyan pen and a solid, blue brush, and a bold Helvetica font.</p>
<div class="fragment"><div class="line">LOGPEN lpen = { PS_SOLID, {2000,2000}, RGB(0,0xff,0xff) };</div><div class="line">LOGBRUSH lbrush = { BS_SOLID, RGB(0x0,0x0,0xff), HS_HORIZONTAL };</div><div class="line">HPEN pen = CreatePenIndirect( &amp;lpen );</div><div class="line">HBRUSH brush = CreateBrushIndirect( &amp;lbrush );</div><div class="line">HFONT font = CreateFont( -1100, 0, 0, 0, FW_BOLD, 0, 0, 0, ANSI_CHARSET,</div><div class="line">                   OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS, DEFAULT_QUALITY,</div><div class="line">                   DEFAULT_PITCH | FF_DONTCARE, <span class="stringliteral">&quot;Helvetica&quot;</span> );</div><div class="line"></div><div class="line"><span class="comment">// Make these the active objects for their respective types</span></div><div class="line"></div><div class="line">SelectObject( metaDC, pen );</div><div class="line">SelectObject( metaDC, brush );</div><div class="line">SelectObject( metaDC, font );</div></div><!-- fragment --><p>Set the window size to the natural coordinates of the drawing. Here, we want to draw on a 100x100 grid.</p>
<div class="fragment"><div class="line">SetWindowExtEx( metaDC, 100, 100, 0 );</div></div><!-- fragment --><p>Now, we can draw as we like. For example, we'll make a solid background with some text centered in the window.</p>
<div class="fragment"><div class="line">Rectangle( metaDC, 0, 0, 100, 100 );</div><div class="line"></div><div class="line">SetTextColor( metaDC, RGB(0,0xff,0) );</div><div class="line">SetTextAlign( metaDC, TA_CENTER+TA_BASELINE );</div><div class="line">SetBkMode( metaDC, TRANSPARENT );</div><div class="line">TextOutA( metaDC, 50, 50, <span class="stringliteral">&quot;Welcome to libEMF&quot;</span>, 17 );</div></div><!-- fragment --><p>Finally, the metafile is written to disk when the metafile is closed. Delete the metafile and its assocated device context to free all the memory they have consumed.</p>
<div class="fragment"><div class="line">   metafile = CloseEnhMetaFile( metaDC );</div><div class="line">   DeleteEnhMetaFile( metafile );</div><div class="line">   DeleteDC( metaDC );</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p>This is result of importing example.emf into OO.org and exporting the drawing as a PNG file (after using The GIMP to crop the transparent boundary).</p>
<div class="image">
<img src="example.png" alt="example.png"/>
</div>
<h1><a class="anchor" id="acknowledgements"></a>
Acknowledgements</h1>
<p>Special thanks to Wolfgang Glunz (<a href="#" onclick="location.href='mai'+'lto:'+'wgl'+'un'+'z@p'+'st'+'oed'+'it'+'.ne'+'t'; return false;">wglun<span style="display: none;">.nosp@m.</span>z@ps<span style="display: none;">.nosp@m.</span>toedi<span style="display: none;">.nosp@m.</span>t.ne<span style="display: none;">.nosp@m.</span>t</a>) for suggestions and help testing.</p>
<hr/>
<p> Copyright &copy; 2002 lignum Computing, Inc., <a href="#" onclick="location.href='mai'+'lto:'+'dal'+'le'+'nba'+'rn'+'ett'+'@u'+'ser'+'s.'+'sou'+'rc'+'efo'+'rg'+'e.n'+'et'; return false;">dalle<span style="display: none;">.nosp@m.</span>nbar<span style="display: none;">.nosp@m.</span>nett@<span style="display: none;">.nosp@m.</span>user<span style="display: none;">.nosp@m.</span>s.sou<span style="display: none;">.nosp@m.</span>rcef<span style="display: none;">.nosp@m.</span>orge.<span style="display: none;">.nosp@m.</span>net</a></p>
<p> 
<HR>
Hosted by <a href="http://sourceforge.net/projects/libemf"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=31968&amp;type=8" width="80" height="15" alt="Get ECMA-234 Metafile Library at SourceForge.net. Fast, secure and Free Open Source software downloads" /></a>
 </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Dec 20 2016 16:04:50 for EMF by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
